\ProvidesExplPackage{magicwatermark}{2024/06/11}{v1.0.1}{magic watermark, author}




\seq_new:N \l__mw_tmpa_seq 
\seq_new:N \l__mw_tmpb_seq 
\seq_new:N \l__mw_tmpc_seq 
\seq_new:N \l__mw_tmpd_seq 

\int_new:N \g__mw_last_page_int 

\AtBeginDocument{
  \int_compare:nTF { \@abspage@last = \number\maxdimen }
  {
    \int_gset:Nn \g__mw_last_page_int { 10 }
  }
  {
    \int_gset:Nn \g__mw_last_page_int { \@abspage@last }
  }
}




\cs_set_nopar:Npn \__mw_range_to_list:nN #1#2 {
  \seq_set_split:Nnn \l__module_tmpa_seq { , } { #1 }
  \seq_map_inline:Nn \l__module_tmpa_seq 
  {
    \tl_if_in:nnTF { ##1 }{ - }
    {
      \seq_set_split:Nnn \l__module_tmpb_seq { - } { ##1 }
      \int_step_inline:nnn 
      { \seq_item:Nn \l__module_tmpb_seq { 1 } } 
      { \seq_item:Nn \l__module_tmpb_seq { 2 } } 
      {
        \clist_put_right:Nn #2 { ####1 }
      }
    }
    {
      \clist_put_right:Nn #2 { ##1 }
    }    
  }
}


